import logging


colors = {
    # ',': "\033[48;5;17m",   # Blue background
    ',': "\033[0m",   # Blue background
    '.': "\033[48;5;15m",   # White stars
    '\'': "\033[48;5;0m",   # Black border
    '@': "\033[48;5;230m",  # Tan poptart
    '$': "\033[48;5;175m",  # Pink poptart
    '-': "\033[48;5;162m",  # Red poptart
    '>': "\033[48;5;9m",    # Red rainbow
    '&': "\033[48;5;202m",  # Orange rainbow
    '+': "\033[48;5;11m",   # Yellow Rainbow
    '#': "\033[48;5;10m",   # Green rainbow
    '=': "\033[48;5;33m",   # Light blue rainbow
    ';': "\033[48;5;19m",   # Dark blue rainbow
    '*': "\033[48;5;8m",    # Gray cat face
    '%': "\033[48;5;175m",  # Pink cheeks
}

frames = [
    [
        ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,",
        ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,",

        (",,,,,,,,,,,,,,," * 4) + ",,,,,,,''''''''''''''',,,,,,,,",
        (">>>>>>>,,,,,,,," * 4) + ">>>>>>'@@@@@@@@@@@@@@@',,,,,,,",
        (">>>>>>>>>>>>>>>" * 4) + ">>>>>'@@@$$$$$$$$$$$@@@',,,,,,",
        (">>>>>>>>>>>>>>>" * 4) + ">>>>>'@@$$$$$-$$-$$$$@@',,,,,,",
        ("&&&&&&&&&&&&&&&" * 4) + "&&&&&'@$$-$$$$$$''$-$$@','',,,",
        ("&&&&&&&&&&&&&&&" * 4) + "&&&&&'@$$$$$$$$'**'$$$@''**',,",
        ("+++++++&&&&&&&&" * 4) + "'''++'@$$$$$-$$'***$$$@'***',,",
        ("+++++++++++++++" * 4) + "**''+'@$$$$$$$$'***''''****',,",
        ("+++++++++++++++" * 4) + "'**'''@$$$$$$$$'***********',,",
        ("#######++++++++" * 4) + "''**''@$$$$$$-'*************',",
        ("###############" * 4) + "#''**'@$-$$$$$'***.'****.'**',",
        ("###############" * 4) + "##''''@$$$$$$$'***''**'*''**',",
        ("=======########" * 4) + "====''@@$$$-$$'*%%********%%',",
        ("===============" * 4) + "====='@@@$$$$$$'***''''''**',,",
        (";;;;;;;========" * 4) + ";;;;'''@@@@@@@@@'*********',,,",
        (";;;;;;;;;;;;;;;" * 4) + ";;;'***''''''''''''''''''',,,,",
        (";;;;;;;;;;;;;;;" * 4) + ";;;'**'','*',,,,,'*','**',,,,,",
        (",,,,,,,;;;;;;;;" * 4) + ",,,'''',,'',,,,,,,'',,'',,,,,,",

        ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,",
        ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,",
    ]
]

class NyanFormatter(logging.Formatter):

    frame = iter(frames[0])

    def format(self, record):
        msgs = str(record.msg).rstrip('\n\r').split('\n')

        lines = []
        for msg in msgs:
            try:
                row = self.frame.next()
            except StopIteration:
                self.frame = iter(frames[0])
                row = self.frame.next()

            msg = iter(msg)

            line = ''
            for i, c in enumerate(row):
                if msg:
                    try:
                        o = msg.next()
                    except StopIteration:
                        o = ' '
                else:
                    o = ' '

                line += (colors[c] + o)

            if msg:
                for c in msg:
                    line += c

            line += '\033[K\033[0m'
            lines.append(line)

        return '\n'.join(lines)

        # return logging.Formatter.format(self, record)

